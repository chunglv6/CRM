package com.viettel.etc.services.impl;import com.viettel.etc.repositories.CustTypeMappingRepository;import com.viettel.etc.dto.CustTypeMappingDTO;import com.viettel.etc.repositories.tables.CustIdTypeMappingRepositoryJPA;import com.viettel.etc.repositories.tables.entities.CustIdTypeMappingEntity;import com.viettel.etc.services.CustTypeMappingService;import com.viettel.etc.services.tables.CustomerServiceJPA;import com.viettel.etc.utils.Constants;import com.viettel.etc.utils.exceptions.EtcException;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.security.core.Authentication;import org.springframework.stereotype.Service;/** * Autogen class: Chung tu cho loai khach hang * * @author ToolGen * @date Tue Sep 08 11:35:14 ICT 2020 */@Servicepublic class CustTypeMappingServiceImpl implements CustTypeMappingService {    @Autowired    private CustTypeMappingRepository custTypeMappingRepository;    @Autowired    private CustIdTypeMappingRepositoryJPA custIdTypeMappingRepositoryJPA;    @Autowired    private CustomerServiceJPA customerServiceJPA;    /**     * Lay danh sach chung tu cho loai khach hang     *     * @param itemParamsEntity params client     * @return     */    @Override    public Object find(CustTypeMappingDTO itemParamsEntity) {        return custTypeMappingRepository.find(itemParamsEntity);    }    /**     * Them moi chung tu cho loai khach hang     *     * @param params         Du lieu loai chung tu     * @param authentication Xac thuc tai khoan     * @return Object     * @throws EtcException Tra ve khi gap loi EtcException     * @throws Exception    Throw khi gap loi Exception     */    @Override    public Object insert(CustTypeMappingDTO params, Authentication authentication) throws EtcException, Exception {        return custTypeMappingRepository.insert(params, authentication);    }    /**     * Tim kiem chung tu loai khach hang theo ma dinh danh     *     * @param id Ma dinh danh chung tu loai khach hang     * @return Object     */    @Override    public Object findOne(Long id) {        return custTypeMappingRepository.findOne(id);    }    /**     * Cap nhat trang thai cho chung tu loai khach hang     *     * @param id             Ma dinh danh loai khach hang     * @param authentication Xac thuc tai khoan     * @return Object     * @throws EtcException Tra ve khi gap loi EtcException     * @throws Exception    Throw khi gap loi Exception     */    @Override    public Object updateStatus(Long id, Authentication authentication) throws EtcException, Exception {        return custTypeMappingRepository.updateStatus(id, authentication);    }    /**     * Xoa du lieu chung tu loai khach hang theo ma dinh danh     *     * @param id Ma dinh danh chung tu loai khach hang     * @return true thanh cong, false that bai     */    @Override    public Boolean delete(Long id) {        CustIdTypeMappingEntity obj = custIdTypeMappingRepositoryJPA.findById(id).get();        if(customerServiceJPA.existsByCustTypeIdAndDocumentTypeId(obj.getCustTypeId(),obj.getDocumentTypeId())){            throw  new EtcException("crm.validate.cust.type.mapping.used");        }        if (!custIdTypeMappingRepositoryJPA.existsById(id) && obj.getStatus().equals(Constants.CATEGORY_STATUS.ACTIVE)) {            throw new EtcException("crm.err.cust.type.mapping.used");        }        custIdTypeMappingRepositoryJPA.deleteById(id);        return true;    }}